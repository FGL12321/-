[TOC]

# Linux常用命令查询手册

# 1.0 文件的基本属性

## 1.1  Linux文件属主和属组

在 Linux 中我们可以使用 **ll** 或者 **ls –l** 命令来显示一个文件的属性以及文件所属的用户和组

```
dr-xr-xr-x   2 root root 4096 Dec 14  2012 bin
dr-xr-xr-x   4 root root 4096 Apr 19  2012 boot
```

![image-20220909205518955](https://pic-1313413291.cos.ap-nanjing.myqcloud.com/image-20220909205518955.png)

![image-20220909205535279](https://pic-1313413291.cos.ap-nanjing.myqcloud.com/image-20220909205535279.png)

## 1.2  更改文件属性

### 1.2.1 chgrp：更改文件属性

```
chgrp [-R] 属组名 文件名
```

参数选项

- -R：递归更改文件属组，就是在更改某个目录文件的属组时，如果加上-R的参数，那么该目录下的所有文件的属组都会更改。

### 1.2.2 chown：更改文件属主，也可以同时更改文件属组

```
chown [–R] 属主名 文件名
chown [-R] 属主名：属组名 文件名
```

### 1.2.3  chmod：更改文件9个属性

​		Linux文件属性有两种设置方法，一种是数字，一种是符号。

​		Linux 文件的基本权限就有九个，分别是 **owner/group/others(拥有者/组/其他)** 三种身份各有自己的 **read/write/execute** 权限。

​		先复习一下刚刚上面提到的数据：文件的权限字符为： **-rwxrwxrwx** ， 这九个权限是三个三个一组的！其中，我们可以使用数字来代表各个权限，各权限的分数对照表如下：

- r:4
- w:2
- x:1

​		每种身份(owner/group/others)各自的三个权限(r/w/x)分数是需要累加的，例如当权限为： **-rwxrwx---** 分数则是：

- owner = rwx = 4+2+1 = 7
- group = rwx = 4+2+1 = 7
- others= --- = 0+0+0 = 0

​		所以等一下我们设定权限的变更时，该文件的权限数字就是 **770**。变更权限的指令 chmod 的语法是这样的：

```
 chmod [-R] xyz 文件或目录
```

**选项与参数：**

- **xyz** : 就是刚刚提到的数字类型的权限属性，为 **rwx** 属性数值的相加。
- **-R** : 进行递归(recursive)的持续变更，以及连同次目录下的所有文件都会变更

举例来说，如果要将 **.bashrc** 这个文件所有的权限都设定启用，那么命令如下：

```
[root@www ~]# chmod 777 .bashrc
```

# 2.0 处理目录的常用命令

- ls（英文全拼：list files）: 列出目录及文件名
- cd（英文全拼：change directory）：切换目录
- pwd（英文全拼：print work directory）：显示目前的目录
- mkdir（英文全拼：make directory）：创建一个新的目录
- rmdir（英文全拼：remove directory）：删除一个空的目录
- cp（英文全拼：copy file）: 复制文件或目录
- rm（英文全拼：remove）: 删除文件或目录
- mv（英文全拼：move file）: 移动文件与目录，或修改文件与目录的名称

## 2.1 列出目录及文件名

```
[root@www ~]# ls 参数 目录名称
```

- -a ：全部的文件，连同隐藏文件( 开头为 . 的文件) 一起列出来(常用)
- -d ：仅列出目录本身，而不是列出目录内的文件数据(常用)
- -l ：长数据串列出，包含文件的属性与权限等等数据；(常用)

将目录下的所有文件列出来(含属性与隐藏档)

```
[root@www ~]# ls -al ~
```

## 2.2 切换目录

```
#使用 mkdir 命令创建 runoob 目录
[root@www ~]# mkdir runoob

#使用绝对路径切换到 runoob 目录
[root@www ~]# cd /root/runoob/

#使用相对路径切换到 runoob 目录
[root@www ~]# cd ./runoob/

# 表示回到自己的家目录，亦即是 /root 这个目录
[root@www runoob]# cd ~

# 表示去到目前的上一级目录，亦即是 /root 的上一级目录的意思；
[root@www ~]# cd ..
```

## 2.3 显示目前的目录

**常用pwd没什么可说的**

## 2.4 创建一个新的目录

```
#创建单层目录
mkdir test

#创建单层目录
mkdir -p test1/test2/test3/test4

#创建权限目录
mkdir -m 711 test2
```

## 2.5 删除一个空的目录

```
#-p ：从该目录起，一次删除多级空目录
rmdir [-p] 目录名称
```

## 2.6 复制文件或目录

```
[root@www ~]# cp [-adfilprsu] 来源档(source) 目标档(destination)
[root@www ~]# cp [options] source1 source2 source3 .... directory
```

**用 root 身份，将 root 目录下的 .bashrc 复制到 /tmp 下，并命名为 bashrc**

```
[root@www ~]# cp ~/.bashrc /tmp/bashrc
[root@www ~]# cp -i ~/.bashrc /tmp/bashrc
cp: overwrite `/tmp/bashrc'? n  <==n不覆盖，y为覆盖
```

## 2.7 删除文件或目录

```
 rm [-fir] 文件或目录
```

**选项与参数：**

- -f ：就是 force 的意思，忽略不存在的文件，不会出现警告信息；
- -i ：互动模式，在删除前会询问使用者是否动作
- -r ：递归删除啊！最常用在目录的删除了！这是非常危险的选项！

## 2.8 移动文件与目录，或修改文件与目录的名称

```
[root@www ~]# mv [-fiu] source destination
```

**选项与参数：**

- -f ：force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖；
- -i ：若目标文件 (destination) 已经存在时，就会询问是否覆盖！
- -u ：若目标文件已经存在，且 source 比较新，才会升级 (update)

# 3.0 用户和用户组的管理

​		**Linux系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。**

​		用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。

​		每个用户账号都拥有一个唯一的用户名和各自的口令。

​		用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。

实现用户账号的管理，要完成的工作主要有如下几个方面：

- 用户账号的添加、删除与修改。
- 用户口令的管理。
- 用户组的管理。

## 3.1 Linux系统用户账号的管理

### 3.1.1添加新用户

```ABAP
useradd 选项 用户名
```

**参数说明：**

- 选项:

  - -c comment 指定一段注释性描述。
  - -d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
  - -g 用户组 指定用户所属的用户组。
  - -G 用户组，用户组 指定用户所属的附加组。
  - -s Shell文件 指定用户的登录Shell。
  - -u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。

- 用户名:

  指定新账号的登录名

```
#此命令创建了一个用户sam，其中-d和-m选项用来为登录名sam产生一个主目录 /home/sam（/home为默认的用户主目录所在的父目录）。
# useradd –d  /home/sam -m sam


#此命令新建了一个用户gem，该用户的登录Shell是 /bin/sh，它属于group用户组，同时又属于adm和root用户组，其中group用户组是其主组
# useradd -s /bin/sh -g group –G adm,root gem
```

### 3.1.2删除账户

```
userdel 选项 用户名
```

​		常用的选项是 **-r**，它的作用是把用户的主目录一起删除。

```
# userdel -r sam
```

​		此命令删除用户sam在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。

### 3.1.3修改账号

```
usermod 选项 用户名
```

常用的选项包括`-c, -d, -m, -g, -G, -s, -u以及-o等`，这些选项的意义与`useradd`命令中的选项一样，可以为用户指定新的资源值

### 3.1.4用户口令管理

==主要运用于修改密码==

​		用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。

​		指定和修改用户口令的Shell命令是`passwd`。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：

```
passwd 选项 用户名
```

**可使用的选项：**

- -l 锁定口令，即禁用账号。
- -u 口令解锁。
- -d 使账号无口令。
- -f 强迫用户下次登录时修改口令。

==如果默认用户名，则修改当前用户的口令==

## 3.2 Linux系统用户组的管理

**1.添加一个用户组**

```ABAP
groupadd 选项 用户组

#查看用户组
cat /etc/group

#此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101
groupadd -g 101 group2
```

- -g GID 指定新用户组的组标识号（GID）。
- -o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。

**2.删除一个已有用户组**

```ABAP
groupdel 用户组
```

**3.修改用户组的属性使用groupmod命令**

```ABAP
groupmod 选项 用户组
```

- -g GID 为用户组指定新的组标识号。
- -o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。
- -n新用户组 将用户组的名字改为新名字

```ABAP
#此命令将组group2的组标识号修改为102
groupmod -g 102 group2 
#此命令将组group2的标识号改为10000，组名修改为group3
groupmod –g 10000 -n group3 group2
```

**4.一个用户属于多个用户组，可以在用户组之间切换**

```ABAP
 newgrp root
```

## 3.3 与用户账号有关的系统文件

​		完成用户管理的工作有许多种方法，但是每一种方法实际上都是对有关的系统文件进行修改。与用户和用户组相关的信息都存放在一些系统文件中，包括/etc/passwd,/etc/group等。

**下面分别介绍这些文件的内容：**

**1、/etc/passwd文件是用户管理工作涉及的最重要的一个文件**

Linux系统中的每个用户都在/etc/passwd文件中有一个对应的记录行，它记录了这个用户的一些基本属性

```ABAP
＃ cat /etc/passwd

root:x:0:0:Superuser:/:
daemon:x:1:1:System daemons:/etc:
bin:x:2:2:Owner of system commands:/bin:
sys:x:3:3:Owner of system files:/usr/sys:
adm:x:4:4:System accounting:/usr/adm:
uucp:x:5:5:UUCP administrator:/usr/lib/uucp:
auth:x:7:21:Authentication administrator:/tcb/files/auth:
cron:x:9:16:Cron daemon:/usr/spool/cron:
listen:x:37:4:Network daemon:/usr/net/nls:
lp:x:71:18:Printer administrator:/usr/spool/lp:
```

​		从上面的例子我们可以看到，/etc/passwd中一行记录对应着一个用户，每行记录又被冒号(:)分隔为7个字段，其格式和具体含义如下：

```ABAP
sam  :x   :200    :50      :Sam san:/home/sam:/bin/sh
用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell
```

**2、/etc/shadow文件介绍**

它的文件格式与/etc/passwd类似，由若干个字段组成，字段之间用":"隔开。这些字段是：

```ABAP
＃ cat /etc/shadow

root:Dnakfw28zf38w:8764:0:168:7:::
daemon:*::0:0::::
bin:*::0:0::::
sys:*::0:0::::
adm:*::0:0::::
uucp:*::0:0::::
nuucp:*::0:0::::
auth:*::0:0::::
cron:*::0:0::::
listen:*::0:0::::
lp:*::0:0::::
sam:EkdiSECLWPdSa:9740:0:0::::
```

```ABAP
登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志
```

**2、/etc/group文件中存放用户组的所有信息**

​		将用户分组是Linux 系统中对用户**进行管理及控制访问权限的一种手段**。

​		每个用户都属于某个用户组；**一个组中可以有多个用户，一个用户也可以属于不同的组**。

​		当一个用户同时是多个组中的成员时，在/etc/passwd文件中记录的是用户所属的主组，也就是登录时所属的默认组，而其他组称为附加组。

​		用户要访问属于附加组的文件时，必须首先使用newgrp命令使自己成为所要访问的组中的成员。

​		用户组的所有信息都存放在/etc/group文件中。此文件的格式也类似于/etc/passwd文件，由冒号(:)隔开若干个字段，这些字段有：

```ABAP
root::0:root
bin::2:root,bin
sys::3:root,uucp
adm::4:root,adm
daemon::5:root,daemon
lp::7:root,lp
users::20:root,sam
```

```ABAP
组名:口令:组标识号:组内用户列表
```

# 4.0 vim常用操作命令

## 4.1vim编辑器的四种模式

![image-20220909221943923](https://pic-1313413291.cos.ap-nanjing.myqcloud.com/image-20220909221943923.png)

**☆ 命令模式**
使用VIM编辑器时，默认处于命令模式。在该模式下可以移动光标位置，可以通过快捷键对文件内容进行复制、粘贴、删除等操作。



**☆ 编辑模式或输入模式**
在命令模式下**输入小写字母a或小写字母i即可进入编辑模式**，在该模式下可以对文件的内容进行编辑



**☆ 末行模式**
在命令模式下**输入冒号:即可进入末行模式**，可以在末行输入命令来对文件进行**查找、替换、保存、退出等操作**



**☆ 可视化模式**
可以做一些列选操作（通过方向键选择某些列的内容,类似于Windows鼠标刷黑）



## 4.2常用操作

### 4.2.1命令模式下移动光标

| 移动光标的方法     |                      |
| :----------------- | -------------------- |
| h 或 向左箭头键(←) | 光标向左移动一个字符 |
| j 或 向下箭头键(↓) | 光标向下移动一个字符 |
| k 或 向上箭头键(↑) | 光标向上移动一个字符 |
| l 或 向右箭头键(→) | 光标向右移动一个字符 |
| gg                 | 光标移动到第一行     |

### 4.2.2命令模式下删除内容

| 删除方式 |                                |
| -------- | ------------------------------ |
| x        | 向前删除一个字符               |
| nx       | 连续向后删除 n 个字符，n为数字 |
| dd       | 剪切/删除光标所在行            |



### 4.2.3命令模式下 复制、剪切、粘贴

| 复制，剪切，粘贴 |                                                          |
| ---------------- | -------------------------------------------------------- |
| y1G              | 复制游标所在行到第一行的内容                             |
| yG               | 复制游标所在行到最后一行的内容                           |
| y0               | 复制光标所在的那个字符到该行行首的所有数据               |
| y$               | 复制光标所在的那个字符到该行行尾的所有数据               |
| p, P             | p 为将已复制的数据在光标下一行贴上，P 则为贴在游标上一行 |



### 4.2.4返回上一步操作

==命令模式下：u==

### 4.2.5搜索

```
/输入要查找的单词
```

![image-20220909225209624](https://pic-1313413291.cos.ap-nanjing.myqcloud.com/image-20220909225209624.png)

```
?word
```

**向光标之上寻找一个字符串名称为 word 的字符串**

### 4.2.6命令模式与插入模式常用命令

| 指令行的储存、离开等指令                                     |                                                              |
| :----------------------------------------------------------- | ------------------------------------------------------------ |
| :w                                                           | 将编辑的数据写入硬盘档案中(常用)                             |
| :w!                                                          | 若文件属性为『只读』时，强制写入该档案。不过，到底能不能写入， 还是跟你对该档案的档案权限有关啊！ |
| :q                                                           | 离开 vi (常用)                                               |
| :q!                                                          | 若曾修改过档案，又不想储存，使用 ! 为强制离开不储存档案。    |
| 注意一下啊，那个惊叹号 (!) 在 vi 当中，常常具有『强制』的意思～ |                                                              |
| :wq                                                          | 储存后离开，若为 :wq! 则为强制储存后离开 (常用)              |
| ZZ                                                           | 这是大写的 Z 喔！如果修改过，保存当前文件，然后退出！效果等同于(保存并退出) |
| ZQ                                                           | 不保存，强制退出。效果等同于 **:q!**。                       |
| :w [filename]                                                | 将编辑的数据储存成另一个档案（类似另存新档）                 |
| :r [filename]                                                | 在编辑的数据中，读入另一个档案的数据。亦即将 『filename』 这个档案内容加到游标所在行后面 |
| :n1,n2 w [filename]                                          | 将 n1 到 n2 的内容储存成 filename 这个档案。                 |
| :! command                                                   | 暂时离开 vi 到指令行模式下执行 command 的显示结果！例如 『:! ls /home』即可在 vi 当中察看 /home 底下以 ls 输出的档案信息！ |

# 5.0 防火墙设置常用命令

### **启动防火墙： systemctl start firewalld**

### **查看防火墙状态： systemctl status firewalld**

### **停止防火墙： systemctl disable firewalld**

### **禁用防火墙： systemctl stop firewalld**

### 永久关闭防火墙：chkconfig iptables off

### 重启防火墙：firewall-cmd --reload

### 开放端口命令：firewall-cmd --permanent --add-port=3306/tcp

### 移除端口命令：firewall-cmd --permanent --remove-port=3306/tcp

### 查看防火墙保护规则：firewall-cmd --list-all